<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Neon AI Video Clipper</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
    <style>
        :root { --neon: #00f2ff; --magenta: #ff00e5; --bg: #0d0d0d; }
        body { background: var(--bg); color: white; font-family: 'Orbitron', sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 800px; margin: auto; border: 2px solid var(--neon); padding: 20px; border-radius: 15px; box-shadow: 0 0 20px rgba(0, 242, 255, 0.2); }
        video { width: 100%; border-radius: 10px; margin-top: 20px; border: 1px solid #333; }
        .controls { margin: 20px 0; display: flex; flex-direction: column; gap: 10px; }
        .btn { background: transparent; color: var(--neon); border: 2px solid var(--neon); padding: 15px; cursor: pointer; text-transform: uppercase; font-weight: bold; transition: 0.3s; }
        .btn:hover { background: var(--neon); color: black; box-shadow: 0 0 20px var(--neon); }
        .progress-bar { width: 100%; height: 10px; background: #222; border-radius: 5px; margin-top: 10px; overflow: hidden; display: none; }
        #progress-inner { width: 0%; height: 100%; background: var(--magenta); transition: width 0.3s; }
    </style>
</head>
<body>

<div class="container">
    <h1>AI <span style="color:var(--magenta)">Clipper</span></h1>
    <p style="font-size: 0.8em;">Automatischer Highlight-Schnitt im Browser</p>

    <div class="controls">
        <input type="file" id="uploader" accept="video/*">
        <button class="btn" id="startBtn">Highlight-Video erstellen</button>
    </div>

    <div class="progress-bar" id="progressBar">
        <div id="progress-inner"></div>
    </div>
    <p id="status">Warte auf Video...</p>

    <video id="outputVideo" controls style="display:none;"></video>
</div>

<script>
    const { createFFmpeg, fetchFile } = FFmpeg;
    const ffmpeg = createFFmpeg({ log: true });

    const uploader = document.getElementById('uploader');
    const startBtn = document.getElementById('startBtn');
    const status = document.getElementById('status');
    const progressInner = document.getElementById('progress-inner');
    const progressBar = document.getElementById('progressBar');

    startBtn.addEventListener('click', async () => {
        const file = uploader.files[0];
        if (!file) return alert("Bitte Video wählen!");

        status.innerText = "Lade FFmpeg Kern...";
        progressBar.style.display = "block";
        if (!ffmpeg.isLoaded()) await ffmpeg.load();

        status.innerText = "Verarbeite Video (KI-Schnitt)...";
        ffmpeg.FS('writeFile', 'input.mp4', await fetchFile(file));

        // Logik: Wir schneiden 3 Segmente à 3 Sekunden aus verschiedenen Teilen des Videos
        // Ein echter KI-Ersatz: Wir nehmen den Anfang, die Mitte und das Ende.
        await ffmpeg.run('-i', 'input.mp4', '-t', '3', '-ss', '00:00:02', 'part1.mp4');
        progressInner.style.width = "33%";
        
        await ffmpeg.run('-i', 'input.mp4', '-t', '3', '-ss', '00:00:10', 'part2.mp4');
        progressInner.style.width = "66%";
        
        await ffmpeg.run('-i', 'input.mp4', '-t', '3', '-ss', '00:00:20', 'part3.mp4');

        // Teile zusammenfügen
        status.innerText = "Kombiniere Highlights...";
        await ffmpeg.run('-f', 'concat', '-safe', '0', '-i', 'list.txt', '-c', 'copy', 'output.mp4');
        
        // Erstelle die Liste für FFmpeg (intern)
        ffmpeg.FS('writeFile', 'list.txt', "file 'part1.mp4'\nfile 'part2.mp4'\nfile 'part3.mp4'");
        await ffmpeg.run('-f', 'concat', '-i', 'list.txt', '-c', 'copy', 'final.mp4');

        const data = ffmpeg.FS('readFile', 'final.mp4');
        const video = document.getElementById('outputVideo');
        video.src = URL.createObjectURL(new Blob([data.buffer], { type: 'video/mp4' }));
        video.style.display = "block";
        
        status.innerText = "Fertig! Dein Short ist bereit.";
        progressInner.style.width = "100%";
    });
</script>

</body>
</html>
